Общая классификация XSS

Четкой классификации для межсайтового скриптинга не существует, но экспертами по всему миру выделено три основных типа.

Хранимые XSS (постоянные). Один из самых опасных типов уязвимостей, так как позволяет злоумышленнику получить доступ к 
серверу и уже с него управлять вредоносным кодом (удалять, модифицировать). Каждый раз при обращении к сайту выполняется 
заранее загруженный код, работающий в автоматическом режиме. В основном таким уязвимостям подвержены форумы, порталы, блоги, 
где присутствует возможность комментирования в HTML без ограничений. Вредоносные скрипты с легкостью могут быть встроены как в 
текст, так и в картинки, рисунки.

Отраженные XSS (непостоянные). В этом случае вредоносная строчка выступает в роли запроса жертвы к зараженному веб-сайту. 
Работает этот принцип по следующей схеме:

    Злоумышленник заранее создает URL-ссылку, которая будет содержать вредоносный код и отправляет его своей жертве.
    Она направляет этот URL-запрос на сайт (переходит по ссылке).
    Сайт автоматически берет данные из вредоносной строки и подставляет в виде модифицированного URL-ответа жертве.
    В итоге в браузере у жертвы выполняется вредоносный скрипт, который и содержится в ответе, а злоумышленник получает все 
    cookies этого пользователя.

DOM-модели. В этом варианте возможно использование как хранимых XSS, так и отраженных. Суть заключается в следующем:

    Злоумышленник создает URL-адрес, который заранее содержит вредоносный код, и отправляет его по электронной почте или 
    любым другим способом пользователю.
    Человек переходит по этой ссылке, зараженный сайт принимает запрос, исключая вредоносную строку.
    На странице у пользователя выполняется сценарий, в результате чего загружается вредоносный скрипт и злоумышленник получает 
    cookies.

Виды XSS по способу взаимодействия

Так как основная цель злоумышленника – запустить вредоносный скрипт на компьютере жертвы, существует еще и два основных типа 
XSS-атак по способу взаимодействия.

Пассивные. От жертвы требуется определенное действие, чтобы вызвать обработчик событий и запустить вредоносный скрипт в 
установленной форме. Для этого используется социальная инженерия, например отправка электронного письма с призывом перейти по 
ссылке и нажать на определенную область на сайте. Как только пользователь наведет на нужный объект и кликнет по нему, 
запустится вредоносный скрипт. Если же жертва бездействует, код не будет активирован.

Активные. Злоумышленнику не нужно заманивать жертву по специальным ссылкам, так как код встраивается в базах данных или в 
каком-нибудь исполняемом файле на сервере. От пользователя не требуется никакой активности. У форм ввода, как правило, 
установлен специальный обработчик событий, автоматически активирующийся при попадании на эту страничку. 
В итоге все пользователи, перешедшие по этой ссылке, станут жертвами злоумышленника.
